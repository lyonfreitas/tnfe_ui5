sap.ui.define(["./Command","../IncludeUsageIdType"],function(C,I){"use strict";var T={};T.createCommand=function(a,p){var r=JSON.stringify(p);return a+("["+r.length+"]")+r;};T.createRequestCommand=function(a,p,i){return{command:T.createCommand(a,p),method:a,isInitial:i===true};};T.createRequest=function(a,p,i){return{method:a,parameters:p,isInitial:i===true};};function P(i,f,t){if(!i||!f||!t){throw"ProgressLogger: invalid args";}this.context=f;this.loader=t;var h=new Set();this.logPerformance=function(n,a){if(!n||!a){return;}h.add(a);var o={name:n,timestamp:Date.now(),token:a};var m={method:C.addClientLog,url:this.loader.getUrl(),token:f.token,command:T.createCommand(C.addClientLog,o)};this.loader.postMessage(m);};this.getTokens=function(){return h;};this.logPerformanceTiming=function(m,p){var j=this;m.sort(function(a,b){return a.timestamp-b.timestamp;});if(!m.length){return;}h.add(f.token);var k=[];while(m.length){k.push(m.splice(0,10));}k.forEach(function(a){var o={records:[],timestamp:Date.now()};a.forEach(function(l){o.records.push({name:l.name,timestamp:l.timestamp,uuid:l.uuid,duration:l.duration,value:l.value,parent_uuid:p});});var b=T.createCommand(C.performanceTiming,o);j.loader.postPerformanceTiming({method:C.performanceTiming,url:j.loader.getUrl(),token:f.token,command:b});});};}T.mark=function(t){window.performance.mark(t);};T.measure=function(n,s,a){var p=window.performance;if(performance.getEntriesByName(s).length!==0){if(!a){p.measure(n,s);}else{p.measure(n,s,a);}}p.clearMarks(s);if(a){p.clearMarks(a);}p.clearMeasures(n);};T.perfObserve=function(a){if(!window.PerformanceObserver){return;}var _=[];var s;var b=performance.timing.navigationStart;var p=new window.PerformanceObserver(function(l){l.getEntries().forEach(function(f){f.uuid=T.generateToken();f.timestamp=b+f.startTime;if(f.name==="sceneMeasure"){s=f.uuid;}_.push(f);});if(_.find(function(f){return f.name==="sceneCompleted";})){T.measure("sceneMeasure","modelRequested","sceneCompleted");}if(s){_=_.filter(function(f){return f instanceof PerformanceMeasure;});a.progressLogger.logPerformanceTiming(_,s);s="";}});p.observe({entryTypes:["mark","measure"]});};T.createLogger=function(i,a,b){if(!a){return null;}a.progressLogger=new P(i,a,b);T.perfObserve(a);return a.progressLogger;};T.base64ToUint8Array=function(b){var a=atob(b);var l=a.length;var f=new Uint8Array(l);for(var i=0;i<l;i++){f[i]=a.charCodeAt(i);}return f;};T.arrayToColumnMajorMatrixArray16=function(a){if(a.length===16){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]];}if(a.length===12){return[a[0],a[3],a[6],a[9],a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],0.0,0.0,0.0,1.0];}if(a.length===3){return[1,0,0,a[0],0,1,0,a[1],0,0,1,a[2],0,0,0,1];}return null;};T.pushElementIntoMapArray=function(m,k,a){var b=m.get(k);if(!b){b=[];m.set(k,b);}else if(b.length>0&&b[b.length-1]===a){return;}b.push(a);};T.generateToken=function(){return g();};function g(){function s(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}return s()+s()+"-"+s()+"-"+s()+"-"+s()+"-"+s()+s()+s();}var d=["annotationId","closed","contentType","entityId","highlightStyleId","materialId","meshId","name","opacity","renderOrder","transform","visible"];var c=["annotation","bounds","highlight","nodes"];var e=["annotation","drawing","geometry","hotspot","reference","sectionplane","solid","symbol","unknown"];T.configureSceneViewQuery=function(a){var $=d.slice();var b=c.slice();var f=e.slice();if(a.includeAnimation){b.push("animation");}if(a.includeBackground){f.push("background");}if(a.includeParametric){b.push("parametric");f.push("parametric");}if(a.includeUsageId){b=b.concat(I.to$expandQueryParameter(a.includeUsageId));}if(a.pushPMI){f.push("pmi");}var q={$select:$.join(","),$expand:b.join(","),contentTypes:f.join(","),hidden:a.includeHidden};if(a.metadataFilter!=null){q.metadataFilter=a.metadataFilter;}return q;};return T;});
