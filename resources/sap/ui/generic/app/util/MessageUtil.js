/*
 * ! SAPUI5

(c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/ValueState","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ui/core/syncStyleClass","sap/ui/core/Fragment"],function(V,F,a,J,M,s,b){"use strict";var h={badRequest:"400",unauthorized:"401",forbidden:"403",notFound:"404",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500",notImplemented:"501",badGateway:"502",serviceUnavailable:"503",gatewayTimeout:"504",httpVersionNotSupported:"505"};var o={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity",getCollection:"getCollection"};var m;function g(C){var t=[],f;var j=sap.ui.getCore().getMessageManager();var k=j.getMessageModel().getData();var R=[];for(var i=0;i<k.length;i++){f=k[i];var l=f.technicalDetails&&f.technicalDetails.statusCode==="404"&&f.type==="Error";if(f.persistent){if(l){R.push(f);}else{t.push(f);}}}return C?t.concat(R):t;}function c(P,C){var D;D=function(n,f){var i;var j={onMessageDialogClose:function(){f.onMessageDialogClose();i.destroy();},onActionButtonPressed:function(){f.onActionButtonPressed();i.destroy();}};return b.load({name:n,controller:j}).then(function(i){if(C){s(C,P,i);}P.addDependent(P);return i;});};return D;}function d(v,A,f){var t=g();var l=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");if(t.length===0){return Promise.resolve();}r();var S=V.None;for(var i=0;i<t.length&&S!==V.Error;i++){var j=t[i];switch(j.type){case sap.ui.core.MessageType.Error:S=V.Error;break;case sap.ui.core.MessageType.Warning:S=V.Warning;break;case sap.ui.core.MessageType.Success:if(S===sap.ui.core.ValueState.None){S=V.Success;}}}if(t.length===1&&(S===V.Success||S===V.None)){M.show(t[0].message);return Promise.resolve();}var k=(typeof v==="function")?v:c(v.owner,v.contentDensityClass);var D,n,q;var u=function(){D.close();q.setProperty("/backButtonVisible",false);q.setProperty("/messages",[]);q.setProperty("/messageToGroupName",Object.create(null));n.navigateBack();q.getProperty("/resolve")();};var w={onMessageDialogClose:function(){u(q);},onActionButtonPressed:function(){q.getProperty("/actionButtonCallback")();u(q);},onBackButtonPress:function(){q.setProperty("/backButtonVisible",false);n.navigateBack();},onMessageSelect:function(){q.setProperty("/backButtonVisible",true);}};return k("sap.ui.generic.app.fragments.MessageDialog",w).then(function(x){D=x;n=D.getContent()[0];var y=D.getModel();var z=y&&y.getMetaModel();var G=false;var B=!!(f&&f.action);var C=Object.create(null);if(z){t.forEach(function(j){var E=j.getTarget();if(!E){return;}if(E.lastIndexOf("/")>0){E=E.substring(0,E.lastIndexOf("/"));}var H=E.substring(1,E.indexOf("("));var I=H&&z.getODataEntitySet(H);var K=I&&z.getODataEntityType(I.entityType);var L=K&&K["com.sap.vocabularies.UI.v1.HeaderInfo"];var T=L&&L.Title&&L.Title.Value&&L.Title.Value.Path;var N=y.getProperty(E);var O=N&&N[T];if(O){C[j.getId()]=O;G=true;}});}q=D.getModel("settings");if(!q){q=new J({genericGroupName:l.getText("GENERAL_TITLE"),backButtonVisible:false,cancelButtonText:l.getText("DIALOG_CANCEL"),closeButtonText:l.getText("DIALOG_CLOSE")});D.setModel(q,"settings");}q.setProperty("/showActionButton",B);if(B){q.setProperty("/actionButtonText",f.actionLabel);q.setProperty("/actionButtonCallback",f.action);}q.setProperty("/title",A||l.getText("DIALOG_TITLE"));q.setProperty("/messages",t);q.setProperty("/grouping",G);q.setProperty("/state",S);q.setProperty("/resolve",function(){return Promise.resolve();});q.setProperty("/messageToGroupName",C);D.open();return null;});}function r(){var f=sap.ui.getCore().getMessageManager();var t=g(true);if(t.length>0){f.removeMessages(t);}}function e(f,D,i){var t=new sap.ui.core.message.Message({message:f,description:D,type:sap.ui.core.MessageType.Error,processor:i,target:'',persistent:true});sap.ui.getCore().getMessageManager().addMessages(t);}function p(E){var R;m=E&&E.url;if(m){m="/"+m.substring(0,m.indexOf(")")+1);}var f=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var H;if(E instanceof Error){if(E.message){f=E.message;}}else if(E.response){if(E.response.message){f=E.response.message;}var v=E.response.statusCode;H=!Number.isInteger(v)?Number(v):v;if(E.response.headers){for(var i in E.response.headers){if(i.toLowerCase()==="content-type"){var j=E.response.headers[i];if(j.toLowerCase().indexOf("application/json")===0){if(E.response.responseText){var O=JSON.parse(E.response.responseText);if(O&&O.error&&O.error.message&&O.error.message.value){f=O.error.message.value;}}}else if(E.message){f=E.message;}break;}}}}var t=g();R={httpStatusCode:H,messageText:f,description:null,containsTransientMessage:(t.length===0)?false:true};return R;}return{operations:o,httpStatusCodes:h,handleTransientMessages:d,removeTransientMessages:r,addTransientErrorMessage:e,parseErrorResponse:p,getTransientMessages:g};},true);
