/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/suite/ui/commons/library","sap/ui/thirdparty/jquery","sap/ui/core/Control","./SvgBase","./Node","./Line","./Group","./layout/LayeredLayout","./Tooltip","sap/ui/model/json/JSONModel","sap/m/SuggestionItem","./Utils","sap/m/Label","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/SearchField","sap/m/ToolbarSpacer","sap/ui/core/CustomData","sap/ui/model/Filter","sap/m/OverflowToolbarLayoutData","./KeyboardNavigator","sap/ui/core/theming/Parameters","sap/base/Log","sap/ui/performance/Measurement","sap/base/util/uid","sap/base/security/encodeXML","./GraphRenderer","sap/m/ToggleButton","sap/ui/core/routing/HashChanger","sap/m/library","sap/m/Dialog","sap/suite/ui/commons/util/FullScreenUtil"],function(l,q,C,S,N,L,G,c,T,J,d,U,e,O,f,g,h,j,F,k,K,P,m,M,u,n,o,p,H,r,D,s){"use strict";var B=r.ButtonType,t=l.networkgraph.Orientation,v=l.networkgraph.LayoutRenderType,R=l.networkgraph.RenderType;var A="nodes",w="lines",x="groups";var Z=[0.05,0.1,0.25,0.33,0.50,0.67,0.75,0.80,0.90,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],y=1,z=0.4,E=100000;var I={Group:"group",Node:"node",Line:"line",IsLastKey:"islast",TypeKey:"type"};var Q=Object.freeze({Node:"Node",Line:"Line",Group:"Group"});var V=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var W=0,X=100;var Y=d.extend("sap.suite.ui.commons.networkgraph.LimitedSuggestionItem",{render:function(a,i,b,_){if(W++<X){d.prototype.render.call(this,a,i,b,_);}}});var $=S.extend("sap.suite.ui.commons.networkgraph.Graph",{metadata:{library:"sap.suite.ui.commons",properties:{height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},orientation:{type:"sap.suite.ui.commons.networkgraph.Orientation",group:"Behavior",defaultValue:t.LeftRight},enableZoom:{type:"boolean",group:"Behavior",defaultValue:true},enableWheelZoom:{type:"boolean",group:"Behavior",defaultValue:true},backgroundImage:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},backgroundColor:{type:"sap.suite.ui.commons.networkgraph.BackgroundColor",group:"Appearance",defaultValue:"White"},renderType:{type:"sap.suite.ui.commons.networkgraph.RenderType",group:"Appearance",defaultValue:R.Html},noData:{type:"boolean",group:"Behavior",defaultValue:false},noDataText:{type:"string",group:"Behavior",defaultValue:""}},aggregations:{lines:{type:"sap.suite.ui.commons.networkgraph.Line",multiple:true,singularName:"line"},nodes:{type:"sap.suite.ui.commons.networkgraph.Node",multiple:true,singularName:"node"},groups:{type:"sap.suite.ui.commons.networkgraph.Group",multiple:true,singularName:"group"},legend:{type:"sap.ui.core.Control",multiple:false},layoutAlgorithm:{type:"sap.suite.ui.commons.networkgraph.layout.LayoutAlgorithm",multiple:false},statuses:{type:"sap.suite.ui.commons.networkgraph.Status",multiple:true,singularName:"status"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{graphReady:{},afterLayouting:{},beforeLayouting:{},zoomChanged:{},failure:{parameters:{type:"string",message:"string"}},selectionChange:{parameters:{items:{type:"sap.suite.ui.commons.networkgraph.ElementBase[]"}}},searchSuggest:{parameters:{term:{type:"string"}}},search:{parameters:{term:{type:"string"},key:{type:"string"}}}}}});$.FAILURE_TYPE={INCONSISTENT_MODEL:"Inconsistent model",LAYOUT_FAILURE:"Layout failure"};$.prototype.ZOOM_100=y;$.prototype.init=function(){this._fZoomLevel=1;this._mSelectedNodes={};this._mSelectedLines={};this._bIsLayedOut=false;this._bIsFullScreen=false;this._mNodes={};this._bNeedNodeProcessing=true;this._oFullScreenContainer=null;this._bRequiresDataProcessing=true;this._oPanning={};this._oLegendLabels={};this._iRunningLayouts=0;this._oLastLayout=null;this._bIsRtl=sap.ui.getCore().getConfiguration().getRTL();this._oFocus=null;this._tooltip=this._createTooltip();this._bIsInvalid=false;this._oStatuses={};this._aShadedNodes=[];this._createToolbar();};$.prototype.onBeforeRendering=function(){this._bIsRtl=sap.ui.getCore().getConfiguration().getRTL();this.setBusy(false);this.setBusyIndicatorDelay(0);this._iNodeMaxWidth=0;this.getNodes().forEach(function(a){a._resetDimensions();var i=a.getMaxWidth();if(i>this._iNodeMaxWidth){this._iNodeMaxWidth=i;}}.bind(this));this.getLines().forEach(function(a){a._resetLayoutData();});if(!this.getNoData()){this._loadData();}};$.prototype.onAfterRendering=function(){var a="",b=this.getNodes(),i=this._bIsRtl?"direction="+"\"rtl\"":"",_="<rect class=\"sapSuiteFlickerFreeRect\" x=\"0\" y=\"0\"></rect>";this.$divnodes=this.$("divnodes");this.$divgroups=this.$("divgroups");this.$background=this.$("background");this.$tooltips=this.$("tooltiplayer");this.$scroller=this.$("scroller");this._$innerscroller=this.$("innerscroller");this.$legend=this.$("legend");if(this._oFullScreenContainer&&this._bIsFullScreen){this._oFullScreenContainer.$content=this.$();this.$().addClass("sapSuiteUiCommonsNetworkGraphFullScreen");}if(b.length===0||this._bIsInvalid||this.getNoData()){if(this._bIsInvalid){this.$scroller.html("<span class=\"sapSuiteNetworkGraphErrorText\">"+V.getText("NETWORK_GRAPH_WRONGDATA")+"</span>");}if(this._oSuggestionItemsModel){this._oSuggestionItemsModel.setData("");}this.fireGraphReady();return;}this.setBusy(true);b.forEach(function(b1){b1.bOutput=true;});if(this._isDelayedLayouting()){if(!this._isUseNodeHtml()){b.forEach(function(b1){b1._setupWidthAndHeight();a+=b1._render({sizeDetermination:true});a+="</g>";});}var a1=function(){if(this._iNodeMaxWidth){this.$divnodes.css("width",this._iNodeMaxWidth+50+"px");}this._isUseNodeHtml()?this._createDivNodes():this._$innerscroller.append("<svg id=\""+this.getId()+"-sizesvg\""+i+" class=\"sapSuiteUiCommonsNetworkGraphSvg\">"+a+_+"</svg>");b.forEach(function(b1){if(this._isUseNodeHtml()){b1._setupDivDimensions();}else{b1.calculateSizes();b1._setupWidthAndHeight();}}.bind(this));this._preprocessData();sap.ui.getCore().detachThemeChanged(a1);}.bind(this);if(!sap.ui.getCore().isThemeApplied()){sap.ui.getCore().attachThemeChanged(a1);}else{a1();}}};$.prototype.exit=function(){if(this._oFullScreenUtil){this._oFullScreenUtil.cleanUpFullScreen(this);}};$.prototype._beforeRender=function(){this.fireEvent("afterLayouting");};$.prototype._fireFailure=function(a,b){var i=b;if(typeof b==="object"&&b.text){i=b.text;}var _="Graph failure: "+a+": "+i;if(a===$.FAILURE_TYPE.INCONSISTENT_MODEL){_+=" This may be due to the model size restriction. For its increase use model's 'setSizeLimit' method.";}this.fireFailure([a.toString(),i]);m.error(_);};$.prototype.isFullScreen=function(){return this._bIsFullScreen;};$.prototype.toggleFullScreen=function(){this._toggleFullScreen();};$.prototype.preventInvalidation=function(b){this._bPreventInvalidation=b;};$.prototype.scrollToElement=function(a){this._scrollToElement(a);};$.prototype.setSearchSuggestionItems=function(i){var a=[];if(i){i.forEach(function(b){a.push({text:b.getText(),icon:b.getIcon(),key:b.getKey(),description:b.getDescription()});});}this._oSuggestionItemsModel.setData({items:a});};$.prototype.destroyAllElements=function(){this.destroyAggregation(A,false);this.destroyAggregation(x,false);this.destroyAggregation(w,false);};$.prototype.deselect=function(b){var i=[],a=this.$(),_=function(a1){Object.keys(a1).forEach(function(b1){i.push(a1[b1]);a1[b1].setSelected(false);},this);}.bind(this);a.find("."+this.HIGHLIGHT_CLASS).removeClass(this.HIGHLIGHT_CLASS);a.find("."+this.SELECT_CLASS).removeClass(this.SELECT_CLASS);a.find("."+this.VISIBLE_ACTIONS_BUTTONS_CLASS).removeClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);_(this._mSelectedNodes);_(this._mSelectedLines);this._aShadedNodes.forEach(function(a1){a1._setNodeOpacity(false);});this._aShadedNodes=[];this.$(this.LINEBUTTONSID).hide();if(!b&&i.length){this.fireSelectionChange({items:i});}return i;};$.prototype.getFocus=function(){return this._oFocus;};$.prototype.getToolbar=function(){return this._toolbar;};$.prototype.getNodeByKey=function(a){if(this._bRequiresDataProcessing){this._processData();}return this._mNodes[a];};$.prototype.setCustomLegendLabel=function(a){var b;if(a.isGroup===true){b=Q.Group;}else if(a.isLine===true){b=Q.Line;}else{b=a.isNode===false?Q.Line:Q.Node;}if(a.status){this._oLegendLabels[b+a.status]=a.label;this._createLegend();}};$.prototype.updateLegend=function(){this._createLegend();};$.prototype.zoom=function(a){a=a||{};a.deltaY=(a.zoomin!==false)?1:-1;if(a.x&&a.y){a.point={x:a.x,y:a.y};}this._zoom(a);};$.prototype.getZoomLevelMilestones=function(){return Z;};$.prototype.getCurrentZoomLevel=function(){return this._fZoomLevel;};$.prototype.setCurrentZoomLevel=function(a){this._fZoomLevel=a;this._zoomLabel.setText(this._getZoomText());};$.prototype.getCorrectMousePosition=function(a){var b=this.$svg.offset(),i=1,_=1;if(this._iWidth!==this.$svg.width()||this._iHeight!==this.$svg.height()){i=this._iWidth/this.$svg.width();_=this._iHeight/this.$svg.height();}return{x:parseInt((a.x-b.left)*i,10),y:parseInt((a.y-b.top)*_,10)};};$.prototype._createTooltip=function(){var a=new T(this.getId()+"-tooltip");this.addDependent(a);a.create(this);a.attachEvent("afterClose",function(){this.setFocus(this.getFocus());}.bind(this));return a;};$.prototype.defocus=function(){this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS);};$.prototype.setFocus=function(a){if(!a&&!this._oFocus||a&&this._oFocus&&a.item===this._oFocus.item&&a.button===this._oFocus.button){return;}this.defocus();if(this.getFocusDomRef()){this.getFocusDomRef().focus();}if(a){if(a.button){if(a.item instanceof N||a.item instanceof L){a.item._setActionButtonFocus(a.button,true);}else if(a.item instanceof G){if(a.button===G.BUTTONS.MENU){a.item._setMenuButtonFocus(true);}else if(a.button===G.BUTTONS.COLLAPSE){a.item._setCollapseButtonFocus(true);}}}else if(a.item){a.item._setFocus(true);if(a.item instanceof G){a.button=G.BUTTONS.MENU;}}}this._oFocus=a;this._ensureOnScreen(a?a.item:null);this._updateAccessibility(a);};$.prototype._updateAccessibility=function(a){var b=function(){this._setAccessibilityTitle(V.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT"));}.bind(this),i=function(_){if(_==="Expand/Collapse"){if(a.item.getCollapsed()){return V.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+_+" "+V.getText("NETWORK_GRAPH_EXPANDED");}else{return V.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+_+" "+V.getText("NETWORK_GRAPH_COLLAPSED");}}return V.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+_;};if(a){if(a.button){if(a.item instanceof N){if(a.button.title==="Expand/Collapse"){this._setAccessibilityTitle(a.item._getActionButtonTitle(a.button)+" "+a.item._oExpandState);}else{this._setAccessibilityTitle(a.item._getActionButtonTitle(a.button));}}else if(a.item instanceof G){if(a.button===G.BUTTONS.MENU){this._setAccessibilityTitle(i(V.getText("NETWORK_GRAPH_GROUP_DETAIL")));}else if(a.button===G.BUTTONS.COLLAPSE){this._setAccessibilityTitle(i(V.getText("NETWORK_GRAPH_EXPAND_COLLAPSE")));}else{b();}}else{b();}}else if(a.item){this._setAccessibilityTitle(a.item._getAccessibilityLabel());}}else{b();}};$.prototype._processProperties=function(){if(this._bNeedNodeProcessing){this._mSelectedNodes={};this._mSelectedLines={};this.getNodes().forEach(function(a){if(a.getSelected()){this._mSelectedNodes[a.getKey()]=a;}if(a.getCollapsed()){a.setCollapsed(true);}},this);this.getLines().forEach(function(a){if(a.getSelected()){this._mSelectedLines[a._getLineId()]=a;}},this);this._bNeedNodeProcessing=false;}};$.prototype._loadData=function(){if(this.getNodes().length>0){if(!this._processData()){return;}if(!this._isDelayedLayouting()){setTimeout(this._preprocessData.bind(this),0);}}};$.prototype._preprocessData=function(){this._bIsLayedOut=false;this._bImageLoaded=false;this.fireBeforeLayouting();this._applyLayout().then(this._render.bind(this));};$.prototype._getAllElements=function(){return this.getNodes().concat(this.getGroups());};$.prototype._render=function(){this._beforeRender();this._iRunningLayouts--;if(this._iRunningLayouts>0){return;}this._oLastLayout=null;this._createSearchSuggestItems();this._innerRender();this._createLegend();this._processProperties();if(this._fZoomLevel!==1){this.$svg[0].setAttribute("viewBox","0 0 "+this.$svg.width()+" "+this.$svg.height());this.$svg.width(this.$svg.width()*this._fZoomLevel);this.$svg.height(this.$svg.height()*this._fZoomLevel);this.$background.width(this.$svg.width()*this._fZoomLevel);this.$background.height(this.$svg.height()*this._fZoomLevel);if(this._isUseNodeHtml()){var a="scale("+this._fZoomLevel+")";this.$("divnodes").css("transform",a);}this.$("tooltiplayer").css("transform",a);this.$("divgroups").css("transform",a);}this._setLineClasses();if(this._selectElementAfterScroll){this._scrollToElement(this._selectElementAfterScroll);this._selectElementAfterScroll=null;}if(this._oFocus&&this._oFocus.button===G.BUTTONS.COLLAPSE){this._oFocus.item._setCollapseButtonFocus(true);}this._bIsLayedOut=true;this._setupEvents();this._setupKeyboardNavigation();this.setFocus(this.getFocus());if(!this.getBackgroundImage()||this._bImageLoaded){this.setBusy(false);this.fireGraphReady();}if(!this._isSwimLane()&&!this._isTwoColumnsLayout()){this.$("innerscroller").addClass(" sapSuiteUiCommonsNetworkGraphInnerScrollerCenter ");}};$.prototype._createDivNodes=function(){var a=sap.ui.getCore().createRenderManager();this.getNodes().forEach(function(i){i._bMainRender=true;a.renderControl(i);i._bMainRender=false;});a.flush(this.$divnodes[0]);a.destroy();};$.prototype._innerRender=function(a){var b=function(g1){var h1="";g1.forEach(function(i1){h1+=i1._render();i1.bOutput=true;});return h1;};var i=function(){this.$svg.find(".sapSuiteFlickerFreeRect").remove();this._bImageLoaded=true;if(this._bIsLayedOut){this.setBusy(false);this.fireGraphReady();}}.bind(this);var _=function(){var g1=sap.ui.getCore().createRenderManager();this.getGroups().forEach(function(h1){g1.renderControl(h1);});g1.flush(this.$("divgroups")[0],false,true);g1.destroy();}.bind(this);var a1=20,b1=50,c1=function(){var g1=0,h1=0;var i1=function(l1,m1){if(l1>g1){g1=l1;}if(m1>h1){h1=m1;}};this._iWidth=0;this._iHeight=0;this._getAllElements().forEach(function(l1){if(!l1._isIgnored()){i1(l1._iWidth+l1.getX(),l1._iHeight+l1.getY());}},this);this.getLines().forEach(function(l1){if(!l1._isIgnored()){l1.getCoordinates().forEach(function(m1){i1(m1.getX(),m1.getY());});}},this);if(this.getBackgroundImage()){var j1=new Image();j1.onload=function(){this._iWidth=Math.max(this._iWidth,j1.width);this._iHeight=Math.max(this._iHeight,j1.height);this.$svg.width(this._iWidth);this.$svg.height(this._iHeight);this.$background.width(this._iWidth);this.$background.height(this._iHeight);this.$svg.css("background-image","url("+this.getBackgroundImage()+")");this.$svg.css("background-size","cover");i();}.bind(this);j1.onerror=function(){m.warning("Unable to load background image.");i();};j1.src=this.getBackgroundImage();}this._iWidth=Math.round(g1+(this._isTwoColumnsLayout()?0:b1));this._iHeight=Math.round(h1+a1);if(this.getWidth()==="auto"){this.$().width(this._iWidth);}if(this.getHeight()==="auto"){this.$("wrapper").height(this._iHeight);}if(this._isTwoColumnsLayout()){var k1=this._$innerscroller.width();if(this._iWidth<k1){this._iWidth=k1;}}this.$svg.width(this._iWidth);this.$svg.height(this._iHeight);this.$background.width(this._iWidth);this.$background.height(this._iHeight);if(this._isUseNodeHtml()){this.$divnodes.width(this._iWidth);this.$divnodes.height(this._iHeight);this.$divnodes.css("opacity",1);}this.$divgroups.width(this._iWidth);this.$divgroups.height(this._iHeight);this.$tooltips.width(this._iWidth);this.$tooltips.height(this._iHeight);}.bind(this);var d1=function(g1){g1.forEach(function(h1){h1.forEach(function(i1){i1._afterRendering();});});};var e1=this.getNodes(),f1=this.getLines();M.start(this.getId(),"Rendering of a network graph");if(!this._isUseNodeHtml()){this.$("sizesvg").remove();}_();this._$innerscroller.append(this._renderSvg(this._isUseNodeHtml()?[]:b(e1),b(f1)));this.$svg=this.$("networkGraphSvg");this.$background=this.$("background");c1();if(this._isUseNodeHtml()){e1.forEach(function(g1){var h1=g1.$();if(g1._isInCollapsedGroup()){h1.hide();}h1.css("top",g1.getY()+"px");h1.css("left",g1.getX()+"px");});}d1([this._isUseNodeHtml()?[]:e1,f1]);M.end(this.getId());};$.prototype._renderSvg=function(a,b){var i="",_="sapSuiteUiCommonsNetworkGraphSvg sapSuiteUiCommonsNetworkGraphNoSelect "+(this._fZoomLevel<z?" sapSuiteUiCommonsNetworkGraphZoomedOut ":"");var a1=function(b1,c1,_){i+="<g id=\""+this._getDomId(b1)+"\" class=\""+(_||"")+"\">";i+=c1?c1:"";i+="</g>";}.bind(this);i+="<svg id=\""+this.getId()+"-networkGraphSvg\"";if(this._bIsRtl){i+="direction="+"\"rtl\"";}i+=' class=\"'+_+' sapSuiteNetworkGraphSvgMargin ';if(!this._isUseNodeHtml()){i+="sapSuiteNetworkGraphSvgPosition";}i+='\" preserveAspectRatio=\"none\" ';i+=">";i+="<g id=\""+this.getId()+"-svgbody\">";a1("lines",b,"sapSuiteUiCommonsNetworkLines");if(!this._isUseNodeHtml()){a1("nodes",a,"sapSuiteUiCommonsNetworkNodes");}i+="</g>";if(this.getBackgroundImage()){i+="<rect class=\"sapSuiteFlickerFreeRect\" x=\"0\" y=\"0\" height=\"100%\" width=\"100%\"></rect>";}i+="</svg>";if(this._isUseNodeHtml()){i+="<div id=\""+this.getId()+"-background\"></div>";}return i;};$.prototype._isProperKey=function(a){return a||(a==="0");};$.prototype._processData=function(){var i=this._isSwimLane();var a=function(){var b1=0,c1;this.mGroups={};c1=this.getGroups().some(function(d1){var e1=d1.getKey();d1._iNestedLevel=0;if(!this._isProperKey(e1)){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Group without a proper key [index: "+b1+"] found.");return true;}d1._bIsSwimLane=i;d1._resetSize();d1._clearChildren();if(this.mGroups[e1]){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Group with a duplicit key "+e1+" found.");return true;}this.mGroups[e1]=d1;b1++;return false;},this);return c1||this.getGroups().some(function(d1){if(d1.getParentGroupKey()&&!this.mGroups[d1.getParentGroupKey()]){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Group '"+d1.getKey()+"' reffers to a nonexistent parent group '"+d1.getParentGroupKey()+"'.");return true;}return false;},this);}.bind(this);var b=function(){var b1=0;this._mNodes={};return this.getNodes().some(function(c1){if(!this._isProperKey(c1.getKey())){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Node without a proper ID [index: "+b1+"] found.");return true;}var d1=c1.getGroup(),e1;c1._oGroup=null;if(d1){e1=this.mGroups[d1];if(e1){c1._oGroup=e1;e1.aNodes.push(c1);}else{this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Node belonging to a nonexistent group with key "+d1+" found.");return true;}}this._isUseNodeHtml()?c1._resetDimensions():c1._setupWidthAndHeight();c1._clearChildren();c1._rendered=false;if(this._mNodes[c1.getKey()]){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Node with a duplicit key "+c1.getKey()+" found.");return true;}this._mNodes[c1.getKey()]=c1;b1++;return false;},this);}.bind(this);var _=function(){return this.getLines().some(function(b1,c1){var d1=this.getNodeByKey(b1.getFrom()),e1=this.getNodeByKey(b1.getTo());if(!d1){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Line going from a nonexistent node with key "+b1.getFrom()+" found.");return true;}if(!e1){this._fireFailure($.FAILURE_TYPE.INCONSISTENT_MODEL,"Line going to a nonexistent node with key "+b1.getTo()+" found.");return true;}b1._rendered=false;b1._initialized=false;if(d1&&e1){d1.aChildren.push(e1);d1.aLines.push(b1);e1.aParents.push(d1);e1.aParentLines.push(b1);b1._oFrom=d1;b1._oTo=e1;b1._sKey="line_"+d1.getKey()+"-"+e1.getKey()+"["+c1+"]";}if(d1._oGroup){d1._oGroup.aLines.push(b1);d1._oGroup.aChildren.push(e1);}if(e1._oGroup){e1._oGroup.aParentLines.push(b1);e1._oGroup.aParents.push(d1);}return false;},this);}.bind(this);var a1=function(){this.getGroups().forEach(function(b1){var c1=b1.getParentGroupKey();if(c1){var d1=this.mGroups[c1];if(d1){b1._oParentGroup=d1;d1.aChildGroups.push(b1);}}}.bind(this));this.getGroups().forEach(function(b1){var c1=0,d1=b1._oParentGroup,e1=false,f1=b1;while(d1){if(d1.getCollapsed()&&!e1){b1._oCollapsedByParent=d1;e1=true;}f1=d1;d1=d1._oParentGroup;c1++;}b1._iNestedLevel=c1;b1._oTopParentGroup=f1;});}.bind(this);this._bRequiresDataProcessing=false;if(a()||b()||_()){this._bIsInvalid=true;return false;}a1();this._oStatuses={};this.getStatuses().forEach(function(b1){var c1=b1.getKey();if(c1){this._oStatuses[c1]=b1;}},this);this._bIsInvalid=false;return true;};$.prototype._validateLayout=function(){var b,a,i,_="";b=this.getNodes().some(function(a1){if(a1._isIgnored()){return false;}_="Missing coordinates: Node("+a1.getKey()+")";return!((a1._oGroup&&a1._oGroup.getCollapsed())||(isFinite(a1.getX())&&isFinite(a1.getY())));});if(b){this._fireFailure($.FAILURE_TYPE.LAYOUT_FAILURE,_);return false;}if(this._isLayered()){a=this.getGroups().some(function(a1){if(a1._isIgnored()){return false;}_="Missing coordinates: Group("+a1.getKey()+")";return!a1._isEmpty()&&(!isFinite(a1.getX())||!isFinite(a1.getY()));});if(a){this._fireFailure($.FAILURE_TYPE.LAYOUT_FAILURE,_);return false;}}i=this.getLines().some(function(a1){if(a1._isIgnored()){return false;}_="Missing coordinates: Line("+a1.getKey()+")";return!a1._validateLayout();});if(i){this._fireFailure($.FAILURE_TYPE.LAYOUT_FAILURE,_);return false;}return true;};$.prototype._suggest=function(a){var b=function(i){i.addCustomData(new j({key:I.IsLastKey,value:"true",writeToDom:true}));};var _=function(i){var e1=U.find(i.getCustomData(),function(f1){return f1.getKey()===I.IsLastKey;});if(e1){i.removeCustomData(e1);}};var a1=function(i){var e1=U.find(i.getCustomData(),function(f1){return f1.getKey()===I.TypeKey;});return e1&&e1.getValue();};var b1=function(){var e1=this._searchField.getSuggestionItems(),f1,g1,h1;for(var i=0;i<e1.length;i++){f1=e1[i];_(f1);if(i<e1.length-1){g1=a1(f1);h1=a1(e1[i+1]);if(g1&&h1){if((g1===I.Node&&h1===I.Line)||(g1===I.Line&&h1===I.Group)){b(f1);}}}}}.bind(this);var c1=[],d1=this.fireEvent("searchSuggest",{term:a},true);W=0;if(d1){if(a){c1=[new F([new F("text",function(i){return(i.toLowerCase()||"").indexOf(a.toLowerCase())>-1;}),new F("description",function(i){return(i.toLowerCase()||"").indexOf(a.toLowerCase())>-1;})],false)];}this._searchField.getBinding("suggestionItems").filter(c1);b1();}this._searchField.suggest();};$.prototype._getElementSelectFunctionName=function(a){var b="";if(a instanceof N){b="_selectNode";}if(a instanceof L){b="_selectLine";}if(a instanceof G){b="_selectGroup";}return b;};$.prototype._search=function(a,b){var i,_,a1;_=this.fireEvent("search",{term:a,key:b},true);if(!_){return;}if(a){a1=U.find(this.getNodes(),function(a1){return b?a1.getKey()===b:a1.getTitle()===a;});if(!a1){a1=U.find(this.getLines(),function(b1){if(b1._isLoop()){return false;}return b?b1._getLineId()===b:b1._createSuggestionHelpText()===a;});}if(!a1){a1=U.find(this.getGroups(),function(b1){return b1.aNodes.length>0&&(b?b1.getKey()===b:b1.getTitle()===a);});}if(a1){i=this._getElementSelectFunctionName(a1);if(i){this[i]({element:a1,scroll:true,alwaysSelect:true});}}}else{this.deselect(false);this.setFocus(null);}};$.prototype._createToolbar=function(){var a=this;this._toolbar=new O(this.getId()+"-toolbar",{content:[new h()]}).addStyleClass("sapSuiteUiCommonsNetworkGraphToolbar");this.addDependent(this._toolbar);this._searchField=new g({layoutData:new k({priority:sap.m.OverflowToolbarPriority.NeverOverflow,shrinkable:true}),enableSuggestions:true,suggest:function(b){a._suggest(b.getParameter("suggestValue"));},search:function(b){var i=b.getParameter("query"),_=b.getParameter("suggestionItem"),a1;if(_){a1=_.getProperty("key");}a._search(i,a1);}}).addStyleClass("sapSuiteUiCommonsNetworkGraphSearchField");this._toolbar.addContent(this._searchField);this._toolbar.addContent(new p({id:this.getId()+"-legendButton",type:B.Transparent,icon:"sap-icon://legend",tooltip:V.getText("NETWORK_GRAPH_LEGEND"),press:function(b){if(a.$legend.is(":visible")){a.$legend.hide();}else{a.$legend.show();}}}));if(this.getEnableZoom()){this._zoomLabel=new e({layoutData:new k({group:1,priority:sap.m.OverflowToolbarPriority.Disappear}),text:"100%"});this._zoomIn=new f({layoutData:new k({group:1}),type:B.Transparent,ariaDescribedBy:[this._zoomLabel],text:V.getText("CHARTCONTAINER_ZOOMIN"),icon:"sap-icon://zoom-in",tooltip:V.getText("CHARTCONTAINER_ZOOMIN"),press:function(b){a._zoom({deltaY:1});}});this._toolbar.addContent(this._zoomIn);this._toolbar.addContent(this._zoomLabel);this._zoomOut=new f({layoutData:new k({group:1}),type:B.Transparent,ariaDescribedBy:[this._zoomLabel],text:V.getText("CHARTCONTAINER_ZOOMOUT"),icon:"sap-icon://zoom-out",tooltip:V.getText("CHARTCONTAINER_ZOOMOUT"),press:function(b){a._zoom({deltaY:-1});}});this._toolbar.addContent(this._zoomOut);}this._toolbar.addContent(new f({type:B.Transparent,icon:"sap-icon://popup-window",tooltip:V.getText("NETWORK_GRAPH_ZOOMTOFIT"),text:V.getText("NETWORK_GRAPH_ZOOMTOFIT"),press:this._fitToScreen.bind(this)}));this._oFullScreenButton=new f({type:B.Transparent,text:V.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),icon:"sap-icon://full-screen",tooltip:V.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),press:this._toggleFullScreen.bind(this)});this._toolbar.addContent(this._oFullScreenButton);};$.prototype._fitToScreen=function(){var a=this.$scroller.height()/this._iHeight,b=this.$scroller.width()/this._iWidth,_=Math.min(a,b),a1=Z.slice(-1);for(var i=1;i<Z.length;i++){if(_<Z[i]){a1=Z[i-1];break;}}this._zoom({zoomLevel:a1});};$.prototype._getZoomText=function(){return Math.floor((this._fZoomLevel*100))+"%";};$.prototype._toggleFullScreen=function(){if(this._bIsFullScreen==false){this._sControlHeight=this.getHeight();this.setHeight("100%");this._sControlWidth=this.getWidth();this.setWidth("100%");}var a=function(i,b){this._oFullScreenButton.setIcon(i);this._oFullScreenButton.setText(b);this._oFullScreenButton.setTooltip(b);}.bind(this);if(this._bIsFullScreen){a("sap-icon://full-screen",V.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"));}else{a("sap-icon://exit-full-screen",V.getText("CALCULATION_BUILDER_EXIT_FULL_SCREEN_BUTTON"));}this._bIsFullScreen=!this._bIsFullScreen;if(!this._oFullScreenUtil){this._oFullScreenUtil=s;}this._oFullScreenUtil.toggleFullScreen(this,this._bIsFullScreen,this._oFullScreenButton,this._toggleFullScreen);if(this._bIsFullScreen==false){this.setHeight(this._sControlHeight);this.setWidth(this._sControlWidth);}};$.prototype._setupKeyboardNavigation=function(){var _=[],a1=[[]],b1,c1;if(!this._isLayedOut()){return;}this.getNodes().forEach(function(a){if(a.isHidden()||a._isIgnored()||!a.getVisible()){return;}_.push({item:a,x:a.getX(),y:a.getY()});});this.getLines().forEach(function(a){if(a.isHidden()||a._isIgnored()||!a.getVisible()||a.getCoordinates().length<2){return;}var b=a.getCoordinates()[0],i=b.getX(),iY=b.getY();a.getCoordinates().forEach(function(b){if(i>b.getX()){i=b.getX();}if(iY>b.getY()){iY=b.getY();}});_.push({item:a,x:i,y:iY});});this.getGroups().forEach(function(a){if(a.isHidden()||a._isEmpty()||!a.getVisible()){return;}_.push({item:a,x:a.getX(),y:a.getY()});});_.sort(function(a,b){if(a.y<b.y){return-1;}else if(a.y>b.y){return 1;}else if(a.x<b.x){return-1;}else if(a.x>b.x){return 1;}else{return 0;}});if(_.length>0){c1=[_[0]];a1=[c1];b1=_[0];_.forEach(function(a,i){if(i===0){return;}if(a.y===b1.y){c1.push(a);}else{c1=[a];a1.push(c1);}b1=a;});}a1=this._normalizeGrid(a1,_);if(!this._oKeyboardNavigator){this._oKeyboardNavigator=new K(this);this.addDelegate(this._oKeyboardNavigator);}this._oKeyboardNavigator.setItems(a1);this._oKeyboardNavigator.setWrapperDom(this.getFocusDomRef());};$.prototype._normalizeGrid=function(a,b){if(b.length===0){return a;}var _=b[0],a1=_.x,b1=_.x,c1=1,d1,e1,f1=[],i;b.forEach(function(g1){if(g1.x<a1){a1=g1.x;}if(g1.x>b1){b1=g1.x;}});a.forEach(function(g1){if(g1.length>c1){c1=g1.length;}});d1=Math.abs(b1-a1)/c1;e1=a1;for(i=0;i<c1;i++){e1+=d1;f1.push(e1);}return a.map(function(g1){var h1,i1;if(g1.length===c1){h1=g1;}else{h1=[];i1=0;while(i1<(c1-g1.length)&&f1[i1]<g1[0].x){i1++;h1.push(null);}g1.forEach(function(j1){h1.push(j1);i1++;});while(i1<c1){h1.push(null);i1++;}}return h1.map(function(j1){return j1?j1.item:null;});});};$.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper");};$.prototype._setupEvents=function(){var a=5;var i=0,b={},_=this.$("ctrlalert"),a1=this.$scroller;var b1=function(o1,o2){return Math.sqrt(Math.pow(o1.clientX-o2.clientX,2)+Math.pow(o1.clientY-o2.clientY,2));};var c1=function(f1){if(f1.touches&&f1.touches.length===2){b={t1:f1.touches[0],t2:f1.touches[1],diff:b1(f1.touches[0],f1.touches[1])};}};var d1=function(f1){if(f1.touches&&f1.touches.length===2){if(++i===a){var g1=f1.touches[0],h1=f1.touches[1],i1=b1(g1,h1);this._zoom({point:{x:(g1.clientX+h1.clientX)/2,y:(g1.clientY+h1.clientY)/2},deltaY:i1-b.diff});i=0;b={t1:g1,t2:h1,diff:i1};}}}.bind(this);a1.on("mousemove",function(f1){this._mouseMove(f1.clientX,f1.clientY);}.bind(this));var e1=this._isSwimLane()?this.$svg:this.$divgroups;e1.on("mousedown",function(f1){this._mouseDown(f1.clientX,f1.clientY);f1.preventDefault();}.bind(this));a1.on("mouseleave",this._endDragging.bind(this));a1.on("mouseup",this._mouseUp.bind(this));if(this.getEnableZoom()){a1.on("wheel",function(f1){if(this._wheel({x:f1.originalEvent.clientX,y:f1.originalEvent.clientY,deltaY:f1.originalEvent.deltaY,div:_,ctrl:f1.ctrlKey})){f1.preventDefault();}}.bind(this));}a1.on("touchstart",function(f1){c1(f1);});a1.on("touchmove",function(f1){d1(f1);});};$.prototype._wheel=function(a){if(this.getEnableWheelZoom()||a.ctrl){a.div.css("opacity","0");this._zoom({point:{x:a.x,y:a.y},deltaY:-a.deltaY});this._zoomLabel.setText(this._getZoomText());return true;}};$.prototype._endDragging=function(){this._oPanning.dragging=false;this.$scroller.removeClass("sapSuiteUiCommonsNetworkGraphPanning");};$.prototype._mouseMove=function(i,a){var b=this.$scroller[0];if(this._oPanning.dragging){if(!this.$scroller.hasClass("sapSuiteUiCommonsNetworkGraphPanning")){this.$scroller.addClass("sapSuiteUiCommonsNetworkGraphPanning");}b.scrollTop=b.scrollTop-(a-this._oPanning.lastY);b.scrollLeft=b.scrollLeft-(i-this._oPanning.lastX);this._oPanning.lastX=i;this._oPanning.lastY=a;}};$.prototype._mouseDown=function(i,a){this.deselect(false);this.setFocus(null);this._oPanning.lastX=i;this._oPanning.lastY=a;this._oPanning.dragging=true;this._tooltip.instantClose();};$.prototype._mouseUp=function(){this._endDragging();};$.prototype._preventZoomToChangeLineWidth=function(){return this._isLayered()&&(this._fZoomLevel>=0.5&&this._fZoomLevel<2);};$.prototype._setLineClasses=function(){var a=this.$(),b=this._preventZoomToChangeLineWidth()?"addClass":"removeClass",i=(this._fZoomLevel<0.5)?"removeClass":"addClass";a[b]("sapSuiteUiCommonsNetworkGraphDefaultLineWidth");a[i]("sapSuiteUiCommonsNetworkGraphCrispEdges");};$.prototype._zoom=function(a){var b=this.$svg[0].getAttribute("viewBox"),i=a.deltaY<0?-1:1,_,a1,b1,c1;var d1=function(e1){var f1=0,g1;Z.forEach(function(h1,i1){var j1=Math.abs(e1-h1);if(j1<g1||g1===undefined){f1=i1;g1=j1;}});return f1;};if(!a.point){a.point={x:this.$scroller.width()/2,y:this.$scroller.height()/2};}_=this.getCorrectMousePosition({x:a.point.x,y:a.point.y});if(a.zoomLevel||a.zoomLevel===0){this._fZoomLevel=a.zoomLevel;}else{b1=d1(this._fZoomLevel);if(Z.indexOf(this._fZoomLevel)<0){if(this._fZoomLevel>Z[b1]){b1=i<0?b1:b1+i;}else{b1=i>0?b1:b1+i;}}else{b1+=i;}if(b1<0){b1=0;}else if(b1>Z.length-1){b1=Z.length-1;}this._fZoomLevel=Z[b1];}if(this._fZoomLevel<0){this._fZoomLevel=0;}if(!b){c1="0 0 "+Math.round(this.$svg.width())+" "+Math.round(this.$svg.height());this.$svg[0].setAttribute("viewBox",c1);}this.$svg.width(Math.round(this._iWidth*this._fZoomLevel));this.$svg.height(Math.round(this._iHeight*this._fZoomLevel));this.$background.width(Math.round(this._iWidth*this._fZoomLevel));this.$background.height(Math.round(this._iHeight*this._fZoomLevel));a1=this.getCorrectMousePosition({x:a.point.x,y:a.point.y});this.$scroller[0].scrollLeft+=(_.x-a1.x)*this._fZoomLevel;this.$scroller[0].scrollTop+=(_.y-a1.y)*this._fZoomLevel;this._zoomLabel.setText(this._getZoomText());if(this._fZoomLevel<z){this.$svg.addClass("sapSuiteUiCommonsNetworkGraphZoomedOut");}else{this.$svg.removeClass("sapSuiteUiCommonsNetworkGraphZoomedOut");}if(this._isUseNodeHtml()){this.$("divnodes").css("transform","scale("+this._fZoomLevel+")");}this.$("divgroups").css("transform","scale("+this._fZoomLevel+")");this.$tooltips.css("transform","scale("+this._fZoomLevel+")");this._setLineClasses();this.fireEvent("zoomChanged");};$.prototype._createSearchSuggestItems=function(){var a=50;var b={items:[]},i=this.getNodes().sort(function(b1,c1){return b1.getTitle().localeCompare(c1.getTitle());}),_=this.getLines().sort(function(b1,c1){var d1=b1.getTitle(),e1=c1.getTitle();if(d1===e1){return b1.getFromNode().getTitle().localeCompare(c1.getFromNode().getTitle());}return d1.localeCompare(e1);}),a1=this.getGroups().sort(function(b1,c1){return b1.getTitle().localeCompare(c1.getTitle());});this._oSuggestionItemsModel=new J();this._oSuggestionItemsModel.setSizeLimit(E);i.forEach(function(b1){var c1=U.trimText(b1.getTitle(),a);b.items.push({text:c1?c1:b1.getKey(),type:I.Node,icon:b1.getIcon(),key:b1.getKey(),description:"("+V.getText("NETWORK_GRAPH_NODE")+")"});});_.forEach(function(b1){if(b1._isLoop()){return;}if(b1.getTitle()||b1.getFromNode().getTitle()||b1.getToNode().getTitle()){b.items.push({text:b1._createSuggestionHelpText(),type:I.Line,key:b1._getLineId(),description:"("+V.getText("NETWORK_GRAPH_LINE")+")"});}});a1.forEach(function(b1){var c1=U.trimText(b1.getTitle(),a);if(b1.aNodes.length>0){b.items.push({text:c1?c1:b1.getKey(),key:b1.getKey(),type:I.Group,description:"("+V.getText("NETWORK_GRAPH_GROUP")+")"});}});this._oSuggestionItemsModel.setData(b);this._searchField.setModel(this._oSuggestionItemsModel);this._searchField.bindAggregation("suggestionItems",{path:"/items",template:new Y({text:"{text}",icon:"{icon}",key:"{key}",description:"{description}",customData:new j({key:"type",value:"{type}"})})});};$.prototype._scrollToElement=function(i){var b=i._oGroup&&i._oGroup.getCollapsed(),a,_,a1,b1,c1,d1;if(b){i=i._oGroup;}if(i instanceof L){c1=i.getSource();d1=i.getTarget();a1=Math.abs(d1.getX()-c1.getX());b1=Math.abs(d1.getY()-c1.getY());a=Math.min(c1.getX(),d1.getX());_=Math.max(c1.getY(),d1.getY());}else{a=i.getX();_=i.getY();a1=i._iWidth;b1=i._iHeight;}this.$scroller.get(0).scrollLeft=((a+(a1?a1:0)/2)*this._fZoomLevel)-(this.$scroller.width()/2);this.$scroller.get(0).scrollTop=((_+(b1?b1:0)/2)*this._fZoomLevel)-(this.$scroller.height()/2);};$.prototype._ensureOnScreen=function(i){if(!i||!this.$scroller){return;}var a,b,_,a1=this.$scroller[0],b1=a1.scrollLeft/this._fZoomLevel,c1=a1.scrollTop/this._fZoomLevel,d1=b1+this.$scroller.width()/this._fZoomLevel,e1=c1+this.$scroller.height()/this._fZoomLevel;if(!i._isOnScreen(b1,d1,c1,e1)){if(i instanceof N){b=i.getX()+i._iWidth/2;_=i.getY()+i._iHeight/2;}else if(i instanceof L){a=i._getArrowFragmentVector();b=(a.center.x+a.apex.x)/2;_=(a.center.y+a.apex.y)/2;}else if(i instanceof G){b=i.getX();_=i.getY();}if(b<b1||b>d1){a1.scrollLeft=b*this._fZoomLevel-this.$scroller.width()/2;}if(_<c1||_>e1){a1.scrollTop=_*this._fZoomLevel-this.$scroller.height()/2;}}};$.prototype._createLegend=function(){var i=this.$("legend"),_="",a1=this,b1={},c1={},d1={};var e1=function(a,b){var i1=n(a.getStatus());if(i1){if(b[i1]){b[i1].push(a);}else{b[i1]=[a];}}};var f1=function(a){return Object.keys(a).length>0;};var g1=function(a,b,i1){var j1=this._oStatuses[a],k1=j1&&j1._getLegendColor(),l1=k1?"background-color:"+k1:"";_+=this._renderControl("div",{status:a,elementtype:i1,"class":"sapSuiteUiCommonsNetworkGraphLegendLine"},false);_+=this._renderControl("div",{"class":"sapSuiteUiCommonsNetworkGraphLegendColorLine "+this._getStatusClass(a),"style":l1});_+=this._renderControl("label",{"class":"sapSuiteUiCommonsNetworkGraphLegendLineLabel"},false);_+=n(this._oLegendLabels[i1+a]?this._oLegendLabels[i1+a]:b);_+="</label>";_+="</div>";}.bind(this);var h1=function(i1,j1,k1,l1,m1){i1.forEach(function(a){e1(a,j1);});if(f1(j1)){_+="<div class=\""+k1+"\"><label class=\"sapSuiteUiCommonsNetworkGraphLegendTitle\">"+n(V.getText(l1))+"</label></div>";var n1=Object.keys(j1).reduce(function(a,b){var o1;if(this._oLegendLabels[m1+b]){o1=this._oLegendLabels[m1+b];}else{var p1=this._oStatuses[b];o1=p1?(p1.getTitle()||b):V.getText("NETWORK_GRAPH_"+b.toUpperCase());}a[b]=o1;return a;}.bind(this),{});Object.keys(j1).sort(function(a,b){return(n1[a]||"").localeCompare(n1[b]);}).forEach(function(a){g1(a,n1[a],m1);});}}.bind(this);if(this.getLegend()){return;}if(!i[0]){return;}h1(this.getNodes(),b1,"sapSuiteUiCommonsNetworkGraphLegendTitleNode","NETWORK_GRAPH_NODES",Q.Node);h1(this.getLines(),c1,"sapSuiteUiCommonsNetworkGraphLegendTitleLine","NETWORK_GRAPH_LINES",Q.Line);h1(this.getGroups(),d1,"sapSuiteUiCommonsNetworkGraphLegendTitleLine","NETWORK_GRAPH_GROUPS",Q.Group);i.html(_);if(sap.ui.getCore().byId(this.getId()+"-legendButton").getPressed()){this.getDomRef("legend").style.display="block";}this.$().find(".sapSuiteUiCommonsNetworkGraphLegendLine").on("click",function(a){var b=q(this).attr("status"),i1=q(this).attr("elementtype"),j1;if(i1===Q.Node){j1=b1;}if(i1===Q.Line){j1=c1;}if(!a.ctrlKey){a1.deselect(false);a1.setFocus(null);}if(i1!==Q.Group&&j1[b]){j1[b].forEach(function(k1){k1.setSelected(true);});}});};$.prototype._selectElement=function(a){var i=a.element&&!a.element.getSelected(),b=[];var _=function(a1){a.element.setSelected(a1);if(a.setFocus!==false){this.setFocus({item:a.element});}}.bind(this);this.$("svg").find("."+this.VISIBLE_ACTIONS_BUTTONS_CLASS).removeClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);if(!a.preventDeselect){b=this.deselect(true);if(a.setFocus){this.setFocus(null);}if(i||a.alwaysSelect){_(true);}}else{_(i);}if(!a.element._hasFocus()&&a.forceFocus){this.setFocus({item:a.element});}if(!b.some(function(oL){return oL===a.element;})){b.push(a.element);}this.fireSelectionChange({items:b});};$.prototype._selectLine=function(a){var b=a.element.getFromNode(),i=a.element.getToNode(),_=(b._isInCollapsedGroup()&&(b._oGroup===i._oGroup))?i._oGroup:null;if(a.scroll){this._scrollToElement(_||a.element);}if(!_){this._selectElement(a);}};$.prototype._selectNode=function(a){var b=a.element._isInCollapsedGroup()?a.element._oGroup:null;if(a.scroll){this._scrollToElement(b||a.element);}if(!b){this._selectElement(a);if(a.renderActionButtons!==false){a.element.showActionButtons(true);}}};$.prototype._selectGroup=function(a){if(a.scroll){this._scrollToElement(a.element);}this.setFocus({item:a.element});};$.prototype._applyLayout=function(){var a;this._iRunningLayouts++;a=this._getLayoutAlgorithm().layout().catch(function(b){this._fireFailure($.FAILURE_TYPE.LAYOUT_FAILURE,b);return Promise.reject();}.bind(this)).then(function(){return new Promise(function(b,i){if(a.isTerminated()){b();return;}if(this._validateLayout()){b();}else{i();}}.bind(this));}.bind(this));if(this._oLastLayout&&this._iRunningLayouts>1){this._oLastLayout.terminate();}this._oLastLayout=a;return a;};$.prototype._setAccessibilityTitle=function(i){var a,b=this.$("accessibility");if(i===null){a=V.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT");}else if(typeof i==="string"){a=i;}else{a=i._getAccessibilityLabel();}if(b){b.html(n(a));}};$.prototype._isTopBottom=function(){return this.getOrientation()===t.TopBottom||this.getOrientation()===t.BottomTop;};$.prototype._getLayoutAlgorithm=function(){return this.getLayoutAlgorithm()||this._getDefalutLayout();};$.prototype._isUseNodeHtml=function(){return this.getRenderType()===R.Html;};$.prototype._getDefalutLayout=function(){if(!this._oDefalutLayout){this._oDefaultLayout=new c();this._oDefaultLayout.setParent(this,null,true);}return this._oDefaultLayout;};$.prototype._isLayered=function(){var a=this._getLayoutAlgorithm().getLayoutRenderType();return a===v.SwimLanes||a===v.LayeredWithGroups||a===v.TwoColumns;};$.prototype._isSwimLane=function(){return this._getLayoutAlgorithm().getLayoutRenderType()===v.SwimLanes;};$.prototype._isTwoColumnsLayout=function(){return this._getLayoutAlgorithm().getLayoutRenderType()===v.TwoColumns;};$.prototype._isDelayedLayouting=function(){if(this._isUseNodeHtml()){return true;}return this.getNodes().some(function(a){var b=a.hasListeners("computeSizes");return b||a._useAutomaticSize()||a.getTitleLineSize()!==1||a._displayDescription();});};$.prototype._isLayedOut=function(){return this._bIsLayedOut;};$.prototype.setEnableZoom=function(b){if(this._toolbar){this._zoomLabel.setVisible(b);this._zoomIn.setVisible(b);this._zoomOut.setVisible(b);}this.setProperty("enableZoom",b);return this;};$.prototype.destroyAggregation=function(a,b){this._bRequiresDataProcessing=true;C.prototype.destroyAggregation.call(this,a,b);};$.prototype.insertAggregation=function(a,b,i,_){this._bRequiresDataProcessing=true;C.prototype.insertAggregation.call(this,a,b,i,_);};$.prototype.removeAggregation=function(a,b,i){this._bRequiresDataProcessing=true;C.prototype.removeAggregation.call(this,a,b,i);};$.prototype.addAggregation=function(a,b,i){this._bRequiresDataProcessing=true;C.prototype.addAggregation.call(this,a,b,i);};$.prototype.removeAllAggregation=function(a,b){this._bRequiresDataProcessing=true;C.prototype.removeAllAggregation.call(this,a,b);};$.prototype.updateAggregation=function(a){this._bNeedNodeProcessing=true;C.prototype.updateAggregation.call(this,a);};$.prototype.invalidate=function(){if(this._bPreventInvalidation!==true){C.prototype.invalidate.call(this);}};return $;});
